-- 1. A_ITEM 테이블 생성
CREATE TABLE A_ITEM (
  BRAND_CD VARCHAR2(10),
  ITEM_CD VARCHAR2(10),
  ITEM_NM VARCHAR2(100),
  PRICE NUMBER(10),
  PRIMARY KEY (BRAND_CD, ITEM_CD)
);

-- 2. A_OUT_D 테이블 생성
CREATE TABLE A_OUT_D (
  BRAND_CD VARCHAR2(10),
  OUT_DATE DATE,
  ITEM_CD VARCHAR2(10),
  ORDER_QTY NUMBER(10)
);

-- 3. A_ITEM 테이블 데이터 삽입
INSERT INTO A_ITEM VALUES ('1001', '8801', '레쓰비 마일드커피', 500);
INSERT INTO A_ITEM VALUES ('1001', '8802', '레쓰비 카페타임', 700);
INSERT INTO A_ITEM VALUES ('2001', '7723', '게토레이 자몽', 1200);
INSERT INTO A_ITEM VALUES ('2001', '7724', '게토레이 레몬', 1200);
INSERT INTO A_ITEM VALUES ('2001', '7725', '게토레이 오렌지', 1200);
COMMIT;

-- 4. A_OUT_D 테이블 데이터 삽입
INSERT INTO A_OUT_D VALUES ('1001', TO_DATE('2023-03-01','YYYY-MM-DD'), '8801', 1);
INSERT INTO A_OUT_D VALUES ('1001', TO_DATE('2023-03-01','YYYY-MM-DD'), '8801', 2);
INSERT INTO A_OUT_D VALUES ('1001', TO_DATE('2023-03-01','YYYY-MM-DD'), '8802', 3);
INSERT INTO A_OUT_D VALUES ('2001', TO_DATE('2023-03-01','YYYY-MM-DD'), '7723', 1);
INSERT INTO A_OUT_D VALUES ('2001', TO_DATE('2023-03-01','YYYY-MM-DD'), '7723', 1);
INSERT INTO A_OUT_D VALUES ('2001', TO_DATE('2023-03-01','YYYY-MM-DD'), '7724', 2);
INSERT INTO A_OUT_D VALUES ('2001', TO_DATE('2023-03-01','YYYY-MM-DD'), '7725', 3);
COMMIT;

-- 5. SELECT 쿼리 (조건에 맞는 주문 수량 합계)
SELECT D.ITEM_CD, I.ITEM_NM, SUM(D.ORDER_QTY) AS SUM_ORDER_QTY
FROM A_OUT_D D
JOIN A_ITEM I
  ON D.BRAND_CD = I.BRAND_CD AND D.ITEM_CD = I.ITEM_CD
WHERE D.BRAND_CD IN ('1001','2001')
  AND D.ORDER_QTY BETWEEN 1 AND 2 
GROUP BY D.ITEM_CD, I.ITEM_NM;

SELECT M1.*, SYSDATE AS NO 
 FROM A_OUT_M M1
 
SELECT 1 AS NO
    FROM DUAL
UNION ALL
SELECT 2 AS NO
    FROM DUAL
UNION ALL
SELECT 3 AS NO
FROM DUAL
UNION ALL
SELECT 1 AS NO
FROM DUAL;


SELECT LEVEL
FROM DUAL
CONNECT BY LEVEL <= 10

SELECT M1.*, ROWNUM
FROM A_OUT_M M1